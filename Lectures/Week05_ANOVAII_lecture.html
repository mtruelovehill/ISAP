<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title> ANOVA II </title>
    <meta charset="utf-8" />
    <meta name="author" content="Monica Truelove-Hill" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# <b> ANOVA II </b>
]
.subtitle[
## Inferential Statistics in Applied Psychology <br><br>
]
.author[
### Monica Truelove-Hill
]
.institute[
### Department of Clinical Psychology<br>The University of Edinburgh
]

---








### This Week's Key Topics

+ When to use Factorial ANOVA

+ What is an interaction?

+ Interpreting and reporting the results of Factorial ANOVA

+ Power Analyses with Factorial ANOVAs

---
### Recap from last week

+ ANOVAs can be used to compare more than two means. 

  + One-Way ANOVA tests for differences in the dependent variable between 3 or more levels of a single independent variable. 
  
  + **Factorial (Multiway) ANOVA** tests for differences in the dependent variable across &lt;b&gt;multiple&lt;/b&gt; independent variables

--

+ A Factorial ANOVA requires:

  + A continuous dependent variable
  
  + 2 or more categorical independent variables (with at least 2 levels each)

---
### Factorial ANOVA

+ Factorial ANOVAs test for differences in the dependent variable across &lt;b&gt;multiple&lt;/b&gt; independent variables

  + Between-Subjects Factorial ANOVA - all IVs are between-subjects 
  
  + Within-Subjects Factorial ANOVA - all IVs are within-subjects
  
  + Mixed Factorial ANOVA - both between- and within-subjects IVs are included in the analysis


---
### Factorial ANOVA

+ Compares the mean of the dependent variable across multiple levels of multiple independent variable

+ When using factorial ANOVA, you can test for both main effects and interactions

  + When multiple independent variables are included in the model, the **main effects** capture the effect of each independent variable, while holding the other independent variable(s) constant.
  
  + The **interaction** captures the how the effect of one independent variable on the dependent variable *changes* across levels of the other independent variable
  
  + This is also known as **moderation**, as the effect between two variables is being moderated by a third.

---
### Main Effects vs Interactions

&lt;br&gt;

.center[
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-2-1.svg)&lt;!-- --&gt;
]

---
### Main Effects vs Interactions

.center[**Main Effect of IV1**

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-3-1.svg)&lt;!-- --&gt;
]

---
### Main Effects vs Interactions

.center[**Main Effect of IV2**

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-4-1.svg)&lt;!-- --&gt;
]

---
### Main Effects vs Interactions

.center[**Interaction**

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-5-1.svg)&lt;!-- --&gt;
]

---
### Interaction Visualisations

.pull-left[

.center[**Interaction**]
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-6-1.svg)&lt;!-- --&gt;
.center[**Interaction**]
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-7-1.svg)&lt;!-- --&gt;

]

.pull-right[

.center[**Interaction**]
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-8-1.svg)&lt;!-- --&gt;
.center[**No Interaction**]
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-9-1.svg)&lt;!-- --&gt;
]

---
### Interpreting Effects

+ Take caution when interpreting main effects in the presence of an interaction. 

.pull-left[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-10-1.svg)&lt;!-- --&gt;

]

---
### Interpreting Effects

+ Take caution when interpreting main effects in the presence of an interaction. 

.pull-left[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-11-1.svg)&lt;!-- --&gt;
.center[**Main Effect Explained by Interaction**]
]

--

.pull-right[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-12-1.svg)&lt;!-- --&gt;
.center[**Valid Main Effect AND Interaction**]

]

---
class: inverse, middle, center

## Questions?

---
### Hypotheses

+ Because we have multiple independent variables, we often have multiple hypotheses.

  + Hypotheses about main effects
  
  + Hypothesis about interaction

+ A key consideration when working with tests that produce multiple results is to be sure your research aims and hypotheses align with what your focus in the results and discussion. 

---
### Example Scenario

.pull-left[
+ A researcher investigates how type of facial coverage and stimulus ethnicity affect recognition of facial expressions.

+ **Independent Variables:**
  + Facial Coverage (no coverage/mask/sunglasses)
  + Stimulus Ethnicity (In-Group/Out-Group)

+ **Dependent Variable:** Recognition Score
]

.pull-right[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-13-1.svg)&lt;!-- --&gt;


]

---
### Example Scenario

+ The researcher wants to test for 3 possible effects:

  + Is there an effect of facial coverage on expression recognition in children?
  
  + Is there an effect of stimulus ethnicity (in-group/out-group) on expression recognition in children?
  
  + Does the effect of facial coverage on expression recognition differ based on stimulus ethnicity?
  
  
+ All 3 effects can be tested with a single test.

--

** Test Your Understanding:** Which of the above questions reference a main effect and which reference an interaction?

---
### The Logic Behind Factorial ANOVA

+ Recall from last week that ANOVAs evaluate two features in our data:

  + Variance in the dependent variable explained by the independent variable ( `\(SS_{model}\)`)
  
  + Variance in the dependent variable *not* explained by the independent variable ( `\(SS_{residual}\)`)

--

+ With a Factorial ANOVA, the only difference is that `\(SS_{model}\)` is comprised of the variance from each indepedent variable and their interaction(s):

.center[
&lt;img src="images/FactorialSS.png" width="75%" /&gt;
]

---
### The Logic Behind Factorial ANOVA

.pull-left[
+ Recall that `\(SS_{model}\)` is calculated as the distance between the means of each group and the grand mean. 

+ If there is one IV with 3 groups, this distance is computed between the grand mean and each individual within each of the groups.
]

.pull-right[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-15-1.svg)&lt;!-- --&gt;

]

---
### The Logic Behind Factorial ANOVA

.pull-left[
+ When there are multiple IVs, `\(SS_{model}\)` is still calculated as the distance between the means of each group and the grand mean. 

&gt; **Test Your Understanding:** You have 2 between-subjects IVs. One has 2 levels and one has 3 levels. How many total possible groups do you have? 

]

---
### The Logic Behind Factorial ANOVA

.pull-left[
+ When there are multiple IVs, `\(SS_{model}\)` is still calculated as the distance between the means of each group and the grand mean. 

&gt; **Test Your Understanding:** You have 2 between-subjects IVs. One has 2 levels and one has 3 levels. How many total possible groups do you have? 

+ `\(SS_{model}\)` is computed using each of these groups

]

.pull-right[
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-16-1.svg)&lt;!-- --&gt;

]

---
### The Logic Behind Factorial ANOVA

.pull-left.center[

`\(SS_{IV1}\)`: Main Effect of Facial Coverage

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-17-1.svg)&lt;!-- --&gt;
]

--

.pull-right.center[

`\(SS_{IV2}\)`: Main Effect of Stimulus Group

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-18-1.svg)&lt;!-- --&gt;
]

---
### The Logic Behind Factorial ANOVA

.pull-left[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-19-1.svg)&lt;!-- --&gt;
`\(SS_{model}\)` is the difference between **all possible** group means and the grand mean

]

--

.pull-right[
.center[
`$$SS_{model} = SS_{IV1} + SS_{IV2} + SS_{IV1\times IV2}$$`
&lt;img src="images/FactorialSS.png" width="2221" /&gt;
]
]

---
### The Logic Behind Factorial ANOVA

.pull-left[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-21-1.svg)&lt;!-- --&gt;

So...the interaction effect is computed as:

`$$SS_{IV1\times IV2} = SS_{model} - (SS_{IV1} + SS_{IV2})$$`

]

.pull-right[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-22-1.svg)&lt;!-- --&gt;

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-23-1.svg)&lt;!-- --&gt;

]


---
### Simple Effects Analysis

.pull-left[
+ While interaction plots help with interpretation, they don't show which differences across levels are significant.

+ Simple effects analyses test the effect of one independent variable at individual levels of the other(s)
]

.pull-right[

![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-24-1.svg)&lt;!-- --&gt;


]

---
class: center, inverse, middle

### Questions?

---

### Conducting a Factorial ANOVA

1. State your hypothesis

2. Conduct a power analysis

3. Check your data (visualisations/descriptives)

4. Check assumptions

5. Run the test

6. Calculate the effect size/confidence intervals

7. Interpret results

8. Report

---
### Running a Factorial ANOVA

**Step 1: State Your Hypotheses**

+ 3 hypotheses (2 main effects and 1 interaction):

  + RQ1 - Does facial coverage affect recognition of facial expression?
      + `\(H_1\)` Facial Coverage has an effect on recognition of facial expression
  
  + RQ2 - Is there an effect of stimulus group on recognition of facial expression?
      + `\(H_1\)` Participants are more likely to recognise facial expressions in members of their own ethnic group.
    
  + RQ3 - Does the effect of facial coverage on expression recognition change depending upon stimulus group?
      + `\(H_1\)` The effect of facial coverage on expression recognition depends upon stimulus group.


---
### Running a Factorial ANOVA

+ Main Effects Hypotheses:
  
  + Main Effect of Coverage:
      + `\(H_0: \mu_{none} = \mu_{mask} = \mu_{sunglasses}\)`
      + `\(H_1:\)` at least one `\(\mu\)` is different from the other `\(\mu\)`s
    
  + Main Effect of Stimulus Group:
      + `\(H_0: \mu_{consistent} = \mu_{inconsistent}\)`
      + `\(H_1: \mu_{consistent} \neq \mu_{inconsistent}\)`
    
+ Interaction Effect Hypotheses:
      + `\(H_0: C = 0\)`
      + `\(H_1: C \neq 0\)`

&lt;font size="3"&gt; 
  `\(C = (\mu_{consistent}\times\mu_{none}-\mu_{consistent}\times\mu_{mask}-\mu_{consistent}\times\mu_{sunglasses}) - (\mu_{inconsistent}\times\mu_{none}-\mu_{inconsistent}\times\mu_{mask}-\mu_{inconsistent}\times\mu_{sunglasses})\)` &lt;b&gt; OR &lt;/b&gt;
  
  `\(C = (\mu_{consistent}\times\mu_{none}-\mu_{inconsistent}\times\mu_{none})-(\mu_{consistent}\times\mu_{mask} - \mu_{inconsistent}\times\mu_{mask})-(\mu_{consistent}\times\mu_{sunglasses}-\mu_{inconsistent}\times\mu_{sunglasses})\)` 
  &lt;/font&gt;


---
### Running a Factorial ANOVA

**Step 2: Conduct a Power Analysis**

+ [WebPower](https://webpower.psychstat.org/wiki/models/index)

+ You should run a power analysis for each effect of interest

&gt; **Test your Understanding:** How many power analyses should you run in this instance?

--

+ Let's run an a priori power analysis to detect effect size

  + These are useful when working with secondary data, where you already have a pre-existing dataset
  
  + Here, you calculate the effect size you can detect with a given sample.
  
  + Our dataset has 120 participants. Check the effect size we have 80% power to detect, given `\(\alpha\)` = .05.

+ Remember, Webpower computes the effect size `\(f\)`. We'll need to convert it back to `\(\eta^2\)` using the following formula:

`$$\eta^2 = \frac{f^2}{1+f^2}$$`

---
### Running a Factorial ANOVA

**Step 3: Check your data**

+ Compute descriptive statistics

+ Look at relevant plots
  
--

+ Open [these data](https://mtruelovehill.github.io/ISAP/Data/coverageData.sav) in SPSS.



---
### Running a Factorial ANOVA

**Step 4: Check Assumptions**

+ **Normality:** Residuals should be normally distributed

--

  + What are residuals, and why should they be normally distributed?
  
--

.center[
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-25-1.svg)&lt;!-- --&gt;
]


---
### Running a Factorial ANOVA

**Step 4: Check Assumptions**

+ **Normality:** Residuals should be normally distributed
    + Have a look at the histograms &amp; QQ-plots
  
+ **Independence:** Observations/individuals should be sampled independently
    + Consider study design
  
+ **Homogeneity of Variance:** Equal variance between each group/category
    + Visually assess the residuals vs predicted values plot
    + Support this with Levene's Test for between-subjects variables and Mauchly's test for within-subjects variables with &gt; 2 levels


---
### Running a Factorial ANOVA

**Step 5: Run the test**

**Step 6: Calculate the effect size**

**Step 7: Interpret results**

Let's continue in SPSS...


---
### Running a Factorial ANOVA

**Step 8: Report**

We conducted a **2x3 Between-Subjects Factorial ANOVA** to determine the effect of &lt;span style = "color:#F2B66D"&gt; &lt;b&gt; facial coverage (levels: none; mask; sunglasses) &lt;/span&gt;&lt;/b&gt; and &lt;span style = "color:#F2B66D"&gt; &lt;b&gt; stimulus ethnicity (levels: in-group; out-group) &lt;/span&gt;&lt;/b&gt; on &lt;span style = "color:#F2B66D"&gt; &lt;b&gt; facial expression recognition &lt;/span&gt;&lt;/b&gt;. The `\(\alpha\)` threshold was set at .05 for all analyses. An a priori power analysis indicated that 120 participants were sufficient to detect an interaction effect of `\(\eta^2\)` = .08 with a power of 80% and an `\(\alpha\)` threshold of .05.

Facial coverage had a significant effect on expression recognition, &lt;span style = "color:#30726E"&gt;&lt;b&gt; `\(F\)`(2, 114) = 20.49, `\(p\)` &lt; .001, `\(\eta^2_p\)` = .26 &lt;/span&gt;&lt;/b&gt;. However, stimulus group was not associated with expression recognition, &lt;span style = "color:#30726E"&gt;&lt;b&gt; `\(F\)`(1, 144) = 0.53, `\(p\)` = .470, `\(\eta^2_p\)` = .005 &lt;/span&gt;&lt;/b&gt;. 

---
### Running a Factorial ANOVA

**Step 8: Report**

There was a significant interaction between facial coverage and stimulus ethnicity on expression recognition, &lt;span style = "color:#008290"&gt;&lt;b&gt; `\(F\)`(2, 114) = 5.79, `\(p\)` = .004, `\(\eta^2_p\)` = .09 &lt;/span&gt;&lt;/b&gt; (see Figure 1). Simple effects analyses were conducted to probe the interaction. Significant effects were found in both in-group, ** `\(F\)`(2, 114) = 9.44, `\(p\)` &lt; .001, `\(\eta^2_p\)` = .14**, and out-group, ** `\(F\)`(2, 114) = 16.85, `\(p\)` &lt; .001, `\(\eta^2\)` = .23**, conditions. 

Participants who viewed stimuli whose ethnicity was consistent with their own recognised significantly more expressions in stimuli with no facial coverage than those wearing sunglasses, &lt;span style = "color:#F2B66D"&gt; `\(p\)` &lt; .001. &lt;/span&gt; Additionally, they recognised more expressions in those with masks than those with sunglasses, &lt;span style = "color:#F2B66D"&gt; `\(p\)` = .015. &lt;/span&gt; There was no difference in recognition when stimuli were wearing masks and when they had no facial coverage, &lt;span style = "color:#F2B66D"&gt; `\(p\)` = .485. &lt;/span&gt;

Participants viewing stimuli inconsistent with their ethnicity recognised significantly more expressions when stimuli had no facial coverage, as opposed to when they were wearing masks &lt;span style = "color:#F2B66D"&gt; ( `\(p\)` &lt; .001) &lt;/span&gt; or sunglasses &lt;span style = "color:#F2B66D"&gt; ( `\(p\)` &lt; .001) &lt;/span&gt;. There was no difference in recognition when stimuli were wearing masks versus when they were wearing sunglasses &lt;span style = "color:#F2B66D"&gt; ( `\(p\)` = .556) &lt;/span&gt;.

See Table 1 for descriptive data by group.

---
### Running a Factorial ANOVA

**Step 8: Report**

.pull-left[
.center[**Coverage as Between-Subjects Variable...**]
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-26-1.svg)&lt;!-- --&gt;
]

.pull-right[
.center[**If Coverage were Within-Subjects...**]
![](Week05_ANOVAII_lecture_files/figure-html/unnamed-chunk-27-1.svg)&lt;!-- --&gt;
]
---
### Running a Factorial ANOVA

**Step 8: Report**

.center[
&lt;img src="images/coverageDescriptives.png" width="50%" /&gt;
]



---
class: center, inverse, middle

## Questions?

---

.center[
&lt;img src="images/QRCode for ISAP Mid-Semester Feedback.png" width="50%" /&gt;
]






    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
